import{E as u}from"../el-select/el-select.8325e87a.js";import{_ as p,a as _,o as g,c,b as i,F as S,d as m,e as v,n as f,t as o,h as y}from"../index-e6aff8d6.js";const C={name:"SearchSong",data(){return{songlist:[],total:0,pageSize:52,pageNo:1,emitShow:!0}},mounted(){this.eventHub.$on("getSong",e=>{this.getDataForSearch()})},methods:{async getDataForSearch(){let e=await _.getDataForSearch(this.$route.params.keywords,this.$route.params.type,this.pageSize,(this.pageNo-1)*this.pageSize);console.log(e,this.$route.params.keywords,this.$route.params.type),this.songlist=e.data.result.songs,this.total=await e.data.result.songCount,this.emitShow&&(this.$emit("on-child",this.total),this.emitShow=!1,console.log("song"))},handleSizeChange(e){this.pageSize=e,this.getDataForSearch()},handleCurrentChange(e){this.pageNo=e,this.getDataForSearch()},async getUrl(e,t){await this.$store.dispatch("GetMusicData/getMusicUrl",e),await this.$store.dispatch("GetMusicData/getMusicLyric",e),await this.$store.dispatch("GetMusicData/getSongDetail",e),this.eventHub.$emit("goData","Go"),this.playbg(t)},getSinger(e){this.$router.push({name:"singerdatilhotwork",params:{id:e}})},getSongDetail(e){this.$router.push({name:"singerablumsong",query:{id:e}})},playbg(e){let t=this.$refs.play.querySelectorAll(".play");for(let n=0;n<t.length;n++)t[n].classList.remove("active");e.target.className+=" active"},cutString(e,t){return e?e.length>t?e.substring(0,t)+"...":e:""},timeHandel(e){let t=this.timeAdd0(parseInt(e/6e4%60)),n=this.timeAdd0(parseInt(e/1e3%60));return`${t} : ${n}`},timeAdd0(e){return e<9?`0${e}`:e}}},k={class:"search-song"},D={class:"search-song-list"},z={ref:"play"},w={class:"songname pa"},b=["onClick"],N=y('<div class="disp" data-v-13f53026><div class="icon" data-v-13f53026><i class="i1" data-v-13f53026></i><i class="i2" data-v-13f53026></i><i class="i3" data-v-13f53026></i><i class="i4" data-v-13f53026></i></div></div>',1),$=["onClick"],F=["onClick"],V={class:"songtime pa"};function x(e,t,n,M,r,s){const h=u;return g(),c("div",k,[i("div",D,[i("ul",z,[(g(!0),c(S,null,m(r.songlist,(a,d)=>(g(),c("li",{key:a.id,class:f({bg:d%2==0})},[i("div",w,[i("i",{class:"play",onClick:l=>s.getUrl(a.id,l)},null,8,b),i("span",null,o(s.cutString(a.name,16)),1),N]),i("div",{class:"singername pa",onClick:l=>s.getSinger(a.ar[0].id)},o(s.cutString(a.ar[0].name,8)),9,$),i("div",{class:"singerabulm pa",onClick:l=>s.getSongDetail(a.al.id)}," \u300A"+o(s.cutString(a.al.name,8))+"\u300B ",9,F),i("div",V,o(s.timeHandel(a.dt)),1)],2))),128))],512),v(h,{background:"",onSizeChange:s.handleSizeChange,onCurrentChange:s.handleCurrentChange,modelValue:r.pageNo,"onUpdate:modelValue":t[0]||(t[0]=a=>r.pageNo=a),"page-size":r.pageSize,layout:"prev, pager, next",total:r.total,class:"pagination"},null,8,["onSizeChange","onCurrentChange","modelValue","page-size","total"])])])}var H=p(C,[["render",x],["__scopeId","data-v-13f53026"]]);export{H as default};
